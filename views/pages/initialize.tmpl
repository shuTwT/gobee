<div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-2xl w-full space-y-8">
        <div>
            <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                系统初始化
            </h2>
            <p class="mt-2 text-center text-sm text-gray-600">
                请完成以下步骤来初始化您的系统
            </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
            <div class="mb-6">
                <div class="flex items-center">
                    <div class="flex-1 border-t-2 border-gray-300"></div>
                    <div class="flex items-center justify-center mx-4">
                        <span id="step1-indicator"
                            class="flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full font-bold">1</span>
                        <span class="ml-2 font-medium text-gray-900">选择数据库</span>
                    </div>
                    <div class="flex-1 border-t-2 border-gray-300"></div>
                    <div class="flex items-center justify-center mx-4">
                        <span id="step2-indicator"
                            class="flex items-center justify-center w-8 h-8 bg-gray-300 text-gray-600 rounded-full font-bold">2</span>
                        <span class="ml-2 font-medium text-gray-500">连接设置</span>
                    </div>
                    <div class="flex-1 border-t-2 border-gray-300"></div>
                    <div class="flex items-center justify-center mx-4">
                        <span id="step3-indicator"
                            class="flex items-center justify-center w-8 h-8 bg-gray-300 text-gray-600 rounded-full font-bold">3</span>
                        <span class="ml-2 font-medium text-gray-500">管理员账户</span>
                    </div>
                    <div class="flex-1 border-t-2 border-gray-300"></div>
                </div>
            </div>

            <form id="initialize-form" action="/initialize" method="POST">
                <input type="hidden" name="_csrf" value="{{.CSRFToken}}">

                <!-- 步骤1: 选择数据库类型 -->
                <div id="step1" class="step-content">
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">选择数据库类型</h3>
                        <div class="grid grid-cols-1 gap-4 sm:grid-cols-3">
                            <div class="relative">
                                <input type="radio" id="sqlite" name="db_type" value="sqlite" class="hidden peer"
                                    checked>
                                <label for="sqlite"
                                    class="flex flex-col items-center justify-between p-4 text-gray-500 bg-white border border-gray-200 rounded-lg cursor-pointer peer-checked:border-blue-600 peer-checked:text-blue-600 hover:bg-gray-50">
                                    <div class="w-full text-center">
                                        <svg class="w-10 h-10 mx-auto mb-2" fill="currentColor" viewBox="0 0 24 24">
                                            <path
                                                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
                                        </svg>
                                        <h4 class="text-base font-semibold">SQLite</h4>
                                        <p class="text-sm">轻量级文件数据库，适合小型应用</p>
                                    </div>
                                </label>
                            </div>

                            <div class="relative">
                                <input type="radio" id="mysql" name="db_type" value="mysql" class="hidden peer">
                                <label for="mysql"
                                    class="flex flex-col items-center justify-between p-4 text-gray-500 bg-white border border-gray-200 rounded-lg cursor-pointer peer-checked:border-blue-600 peer-checked:text-blue-600 hover:bg-gray-50">
                                    <div class="w-full text-center">
                                        <svg class="w-10 h-10 mx-auto mb-2" fill="currentColor" viewBox="0 0 24 24">
                                            <path
                                                d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zm-1.46-5.47L8.41 11.4l-1.06 1.06 3.18 3.18 6-6-1.06-1.06-4.93 4.95z" />
                                        </svg>
                                        <h4 class="text-base font-semibold">MySQL</h4>
                                        <p class="text-sm">流行的开源关系型数据库</p>
                                    </div>
                                </label>
                            </div>

                            <div class="relative">
                                <input type="radio" id="postgresql" name="db_type" value="postgresql"
                                    class="hidden peer">
                                <label for="postgresql"
                                    class="flex flex-col items-center justify-between p-4 text-gray-500 bg-white border border-gray-200 rounded-lg cursor-pointer peer-checked:border-blue-600 peer-checked:text-blue-600 hover:bg-gray-50">
                                    <div class="w-full text-center">
                                        <svg class="w-10 h-10 mx-auto mb-2" fill="currentColor" viewBox="0 0 24 24">
                                            <path
                                                d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z" />
                                            <path d="M14 17H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                                        </svg>
                                        <h4 class="text-base font-semibold">PostgreSQL</h4>
                                        <p class="text-sm">高级开源关系型数据库</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end">
                        <button type="button" id="next-to-step2"
                            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            下一步
                        </button>
                    </div>
                </div>

                <!-- 步骤2: 数据库连接参数 -->
                <div id="step2" class="step-content hidden">
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">数据库连接参数</h3>

                        <!-- SQLite 参数 -->
                        <div id="sqlite-params" class="db-params">
                            <div class="mb-4">
                                <label for="sqlite-file"
                                    class="block text-sm font-medium text-gray-700 mb-1">数据库文件路径</label>
                                <input type="text" id="sqlite-file" name="sqlite_file"
                                    class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                    placeholder="./data.db" value="./data.db">
                                <p class="mt-1 text-sm text-gray-500">默认将在应用根目录创建数据库文件</p>
                            </div>
                        </div>

                        <!-- MySQL 参数 -->
                        <div id="mysql-params" class="db-params hidden">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="mb-4">
                                    <label for="mysql-host"
                                        class="block text-sm font-medium text-gray-700 mb-1">主机地址</label>
                                    <input type="text" id="mysql-host" name="mysql_host"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="localhost" value="localhost">
                                </div>
                                <div class="mb-4">
                                    <label for="mysql-port"
                                        class="block text-sm font-medium text-gray-700 mb-1">端口</label>
                                    <input type="text" id="mysql-port" name="mysql_port"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="3306" value="3306">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="mb-4">
                                    <label for="mysql-user"
                                        class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                                    <input type="text" id="mysql-user" name="mysql_user"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="root">
                                </div>
                                <div class="mb-4">
                                    <label for="mysql-password"
                                        class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                                    <input type="password" id="mysql-password" name="mysql_password"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm">
                                </div>
                            </div>
                            <div class="mb-4">
                                <label for="mysql-database"
                                    class="block text-sm font-medium text-gray-700 mb-1">数据库名</label>
                                <input type="text" id="mysql-database" name="mysql_database"
                                    class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                    placeholder="gobee">
                            </div>
                        </div>

                        <!-- PostgreSQL 参数 -->
                        <div id="postgresql-params" class="db-params hidden">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="mb-4">
                                    <label for="pg-host"
                                        class="block text-sm font-medium text-gray-700 mb-1">主机地址</label>
                                    <input type="text" id="pg-host" name="pg_host"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="localhost" value="localhost">
                                </div>
                                <div class="mb-4">
                                    <label for="pg-port" class="block text-sm font-medium text-gray-700 mb-1">端口</label>
                                    <input type="text" id="pg-port" name="pg_port"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="5432" value="5432">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="mb-4">
                                    <label for="pg-user"
                                        class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                                    <input type="text" id="pg-user" name="pg_user"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                        placeholder="postgres">
                                </div>
                                <div class="mb-4">
                                    <label for="pg-password"
                                        class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                                    <input type="password" id="pg-password" name="pg_password"
                                        class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm">
                                </div>
                            </div>
                            <div class="mb-4">
                                <label for="pg-database"
                                    class="block text-sm font-medium text-gray-700 mb-1">数据库名</label>
                                <input type="text" id="pg-database" name="pg_database"
                                    class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                    placeholder="gobee">
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" id="back-to-step1"
                            class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            上一步
                        </button>
                        <button type="button" id="next-to-step3"
                            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            下一步
                        </button>
                    </div>
                </div>

                <!-- 步骤3: 超级管理员账户 -->
                <div id="step3" class="step-content hidden">
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">设置超级管理员账户</h3>
                        <div class="mb-4">
                            <label for="admin-username" class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                            <input type="text" id="admin-username" name="admin_username" required
                                class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                placeholder="admin">
                        </div>
                        <div class="mb-4">
                            <label for="admin-email" class="block text-sm font-medium text-gray-700 mb-1">电子邮箱</label>
                            <input type="email" id="admin-email" name="admin_email" required
                                class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                placeholder="admin@example.com">
                        </div>
                        <div class="mb-4">
                            <label for="admin-password" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                            <input type="password" id="admin-password" name="admin_password" required
                                class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                placeholder="请输入至少8位密码">
                        </div>
                        <div class="mb-4">
                            <label for="admin-password-confirm"
                                class="block text-sm font-medium text-gray-700 mb-1">确认密码</label>
                            <input type="password" id="admin-password-confirm" name="admin_password_confirm" required
                                class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"
                                placeholder="请再次输入密码">
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" id="back-to-step2"
                            class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            上一步
                        </button>
                        <button type="submit"
                            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            完成初始化
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 获取步骤元素
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');

        // 获取步骤指示器
        const step1Indicator = document.getElementById('step1-indicator');
        const step2Indicator = document.getElementById('step2-indicator');
        const step3Indicator = document.getElementById('step3-indicator');

        // 获取导航按钮
        const nextToStep2 = document.getElementById('next-to-step2');
        const backToStep1 = document.getElementById('back-to-step1');
        const nextToStep3 = document.getElementById('next-to-step3');
        const backToStep2 = document.getElementById('back-to-step2');

        // 获取数据库类型单选按钮
        const dbTypeRadios = document.querySelectorAll('input[name="db_type"]');

        // 获取数据库参数区域
        const sqliteParams = document.getElementById('sqlite-params');
        const mysqlParams = document.getElementById('mysql-params');
        const postgresqlParams = document.getElementById('postgresql-params');

        // 显示对应的数据库参数
        function showDbParams() {
            const selectedDbType = document.querySelector('input[name="db_type"]:checked').value;

            sqliteParams.classList.add('hidden');
            mysqlParams.classList.add('hidden');
            postgresqlParams.classList.add('hidden');

            if (selectedDbType === 'sqlite') {
                sqliteParams.classList.remove('hidden');
            } else if (selectedDbType === 'mysql') {
                mysqlParams.classList.remove('hidden');
            } else if (selectedDbType === 'postgresql') {
                postgresqlParams.classList.remove('hidden');
            }
        }

        // 初始显示
        showDbParams();

        // 监听数据库类型变化
        dbTypeRadios.forEach(radio => {
            radio.addEventListener('change', showDbParams);
        });

        // 步骤导航
        nextToStep2.addEventListener('click', function () {
            step1.classList.add('hidden');
            step2.classList.remove('hidden');
            step1Indicator.classList.remove('bg-blue-600', 'text-white');
            step1Indicator.classList.add('bg-green-600', 'text-white');
            step2Indicator.classList.remove('bg-gray-300', 'text-gray-600');
            step2Indicator.classList.add('bg-blue-600', 'text-white');
        });

        backToStep1.addEventListener('click', function () {
            step2.classList.add('hidden');
            step1.classList.remove('hidden');
            step2Indicator.classList.remove('bg-blue-600', 'text-white');
            step2Indicator.classList.add('bg-gray-300', 'text-gray-600');
            step1Indicator.classList.remove('bg-green-600');
            step1Indicator.classList.add('bg-blue-600');
        });

        nextToStep3.addEventListener('click', function () {
            step2.classList.add('hidden');
            step3.classList.remove('hidden');
            step2Indicator.classList.remove('bg-blue-600', 'text-white');
            step2Indicator.classList.add('bg-green-600', 'text-white');
            step3Indicator.classList.remove('bg-gray-300', 'text-gray-600');
            step3Indicator.classList.add('bg-blue-600', 'text-white');
        });

        backToStep2.addEventListener('click', function () {
            step3.classList.add('hidden');
            step2.classList.remove('hidden');
            step3Indicator.classList.remove('bg-blue-600', 'text-white');
            step3Indicator.classList.add('bg-gray-300', 'text-gray-600');
            step2Indicator.classList.remove('bg-green-600');
            step2Indicator.classList.add('bg-blue-600');
        });

        // 表单验证
        const form = document.getElementById('initialize-form');
        form.addEventListener('submit', function (event) {
            const password = document.getElementById('admin-password').value;
            const confirmPassword = document.getElementById('admin-password-confirm').value;

            if (password !== confirmPassword) {
                event.preventDefault();
                alert('两次输入的密码不一致，请重新输入');
            }
        });
    });
</script>